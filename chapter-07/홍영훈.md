# Chapter 7: 이벤트 추천 시스템

> **7회차** | 7장 | Event Recommendation System

---

## 📖 핵심 내용 정리

### 1. 요구사항 명확화

- 비즈니스 목표
- 사용자 기능
- 데이터셋의 규모와 라벨링 전략
- 제약

| 항목 | 내용 |
|:---|:---|
| **비즈니스 목표** | 티켓 판매를 늘리는 것 |
| **사용자 기능** | 이벤트(한 번만 발생 후 만료되는 임시 단발성 항목) 예약 가능. 이벤트 속성 = 텍스트 설명, 가격대, 위치, 날짜 및 시간 등. 친구 추가 가능. 다른 사용자 이벤트 초대 가능 |
| **데이터** | 라벨링된 데이터는 없고 상호작용 데이터를 사용하여 학습 데이터셋 구성. 매월 약 100만 건의 무료, 유료 이벤트 진행 |
| **제약** | DAU 100만 명. 두 위치 간 거리와 이동 시간을 효율적으로 계산하기 위해 외부 API 사용 가능 |

---

### 2. 머신러닝 작업으로 문제 구조화

- 머신러닝 목표
- 시스템 입력 및 출력
- 머신러닝 유형

#### 머신러닝 목표

비즈니스 목표인 티켓 판매를 늘리는게 비즈니스 목표이므로 **이벤트 등록수 극대화** 하는 것이 머신러닝 목표

#### 시스템의 입력 및 출력

- **입력**: 사용자
- **출력**: 랭킹된 이벤트

#### 적합한 머신러닝 유형 선택

임베딩 기반 모델을 사용할 수 있으나 이 장에서는 **Pointwise LTR**을 활용

---

### 3. 데이터 준비

- 데이터 엔지니어링
- 피처 엔지니어링

#### 데이터 엔지니어링

- 사용자
- 이벤트
- 사용자-사용자 상호작용
- 사용자-이벤트 상호작용

#### 피처 엔지니어링

> 해당 시스템이 조금 특별한 이유는 이벤트가 끝난 후 더 이상 등록 요청이 생기지 않기 때문에 과거 상호작용 데이터가 많지 않다.
> 이러한 이유로 **본질적으로 cold start 문제**가 된다.

##### 위치 관련 피처

| 피처 | 설명 |
|:---|:---|
| **도보 점수** | 이벤트와 사용자와의 거리에 대한 정보 |
| **도보 점수 유사도** | 과거 사용자가 등록한 이벤트의 거리 평균과 현재 거리 비교 |
| **같은 국가, 도시 여부** | - |
| **접근성 점수 및 접근성 점수 유사도** | - |

##### 시간 관련 피처

| 피처 | 설명 |
|:---|:---|
| **이벤트까지 남은 시간 및 남은 시간 유사도** | 어떤 사용자는 미리미리 계획하는 타입, 그렇지 않은 사용자도 있음 |
| **예상 이동 시간 및 예상 이동 시간 유사도** | - |
| **이벤트 요일/시간** | - |

##### 소셜 관련 피처

| 피처 | 설명 |
|:---|:---|
| **이벤트 등록 사용자 수** | - |
| **노출 수 대비 전체 등록 사용자 수 비율** | - |
| **등록된 사용자 유사도** | 이전 이벤트 등록 사용자 수와의 유사도 |
| **등록한 친구 수** | - |
| **등록한 친구 비율** | - |
| **초대한 친구 수** | - |
| **이벤트 호스트 친구 여부** | - |
| **과거 해당 호스트 주최 이벤트 참여 횟수** | - |

##### 사용자 관련 피처

- 연령 및 성별

##### 이벤트 관련 피처

| 피처 | 설명 |
|:---|:---|
| **이벤트 가격** | - |
| **가격 유사도** | - |
| **해당 이벤트와 과거 등록한 이벤트 유사도** | 이벤트 설명 TF-IDF 코사인 거리 |

#### 조금 더 논의해볼 수 있는 주제

- **배치 피처와 스트리밍 피처 비교**
  - 동적 피처의 예시는 이벤트에 등록한 사용자 수와 이벤트까지 남은 피처
- **피처 연산 효율성**
  - 감쇠계수 사용
  - 임베딩 학습 사용

---

### 4. 모델 선택

모델 선택 및 학습 방법 선택

| 모델 | 장점 | 단점 |
|:---|:---|:---|
| **로지스틱 회귀** | 빠르고 해석이 쉽다 | 비선형 문제를 풀 수 없다 + 다중공선성 |
| **의사 결정 트리** | 빠르다 | 과적합 |
| **GBDT** | 정형 데이터에서 준수한 성능 | 지속적인 학습에는 적합하지 않음 |

#### 모델 선택 기준

GBDT와 신경망 모두 실험에 적합한 후보인데, 이때 **구현이 빠른 GBDT를 초기 기준선**으로 하고 더 이후 시스템을 고도화하면서 신경망 채택

---

### 5. 평가

#### 오프라인 지표

| 지표 | 사용 여부 | 이유 |
|:---|:---:|:---|
| **Recall@k, Precision@k** | ❌ | 순위 품질을 고려하지 못함 |
| **MRR** | ❌ | 순위는 고려하나 첫 번째 정답만 고려 |
| **nDCG** | ❌ | 해당 테스크는 0~1점만 가지고 있기 때문 |
| **mAP** | ✅ | 위와 같은 이유로 mAP를 사용 |

#### 온라인 지표

- 클릭률, 전환률
- 수익 증가율

---

### 💡 해당 장에서의 핵심

해당 장에서의 핵심은 **생애주기가 짧은 이벤트에 대해 cold start 문제가 생기는데, 이를 보완하기 위해 사용자의 선택 이력을 feature로 활용하여 해결하는 것**

> ex) 과거 사용자의 참여 이벤트 거리 평균
